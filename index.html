<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Perdón, pulguita</title>
  <style>
    :root {
      --bg: #0f1724;
      --accent: #ff5973;
      --soft: #f3f6fb;
    }

    * { box-sizing: border-box; }
    html, body {
      height: 100%;
      margin: 0;
      font-family: "Poppins", sans-serif;
      background: linear-gradient(180deg, #071021 0%, #0f1724 100%);
      color: var(--soft);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .card {
      display: grid;
      grid-template-columns: 1fr 350px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 20px;
      padding: 24px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      gap: 20px;
      max-width: 850px;
      width: 100%;
    }

    .left h1 {
      margin: 0 0 8px 0;
      font-size: 28px;
    }

    .subtitle {
      margin-bottom: 20px;
      color: rgba(243, 246, 251, 0.7);
    }

    .message-box {
      background: rgba(255, 255, 255, 0.02);
      border-radius: 12px;
      padding: 16px;
      min-height: 170px;
      display: flex;
      align-items: flex-start;
      gap: 12px;
    }

    .avatar {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent), #ffb199);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 18px;
      color: #fff;
      flex-shrink: 0;
    }

    .typed {
      font-size: 16px;
      line-height: 1.5;
      white-space: pre-wrap;
    }

    .controls {
      margin-top: 14px;
    }

    .btn {
      background: linear-gradient(90deg, var(--accent), #ff8aa0);
      border: none;
      padding: 10px 16px;
      border-radius: 10px;
      color: #fff;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(255, 89, 115, 0.2);
    }

    .right {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 18px;
    }

    .heart-wrap {
      width: 250px;
      height: 250px;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* corazón más realista */
    .heart {
      position: relative;
      width: 150px;
      height: 150px;
      transform: rotate(-45deg);
      background: var(--accent);
      animation: beat 1.5s infinite;
    }

    .heart:before,
    .heart:after {
      content: "";
      position: absolute;
      width: 150px;
      height: 150px;
      background: var(--accent);
      border-radius: 50%;
    }

    .heart:before {
      top: -75px;
      left: 0;
    }

    .heart:after {
      left: 75px;
      top: 0;
    }

    @keyframes beat {
      0%, 100% { transform: rotate(-45deg) scale(1); }
      50% { transform: rotate(-45deg) scale(1.1); }
    }

    #confetti {
      position: fixed;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9999;
    }

    @media (max-width: 800px) {
      .card {
        grid-template-columns: 1fr;
        text-align: center;
      }
      .heart-wrap { margin-top: 20px; }
    }
  </style>
</head>
<body>
  <canvas id="confetti"></canvas>

  <div class="card">
    <div class="left">
      <h1>Pulguita, necesito decirte algo</h1>
      <p class="subtitle">Haz click en "Leer mi disculpa" y deja que te diga con el corazón lo que siento.</p>

      <div class="message-box">
        <div class="avatar">❤</div>
        <div>
          <div id="typed" class="typed">Pulsa el botón para leer mi disculpa...</div>
          <div class="controls">
            <button id="startBtn" class="btn">Leer mi disculpa</button>
            <button id="againBtn" class="btn" style="display:none">Volver a leer</button>
          </div>
        </div>
      </div>
    </div>

    <div class="right">
      <div class="heart-wrap">
        <div class="heart"></div>
      </div>
    </div>
  </div>

  <script>
    const text = `Pulguita, perdóname por la discusión de hoy.
Sé que te hice daño y lo siento de verdad.
Te amo con todo mi corazón y no quiero que una pelea nos aleje.
Eres mi alegría, mi calma y mi persona favorita.
Por favor acepta estas palabras; quiero mejorar y estar mejor contigo.
Siempre tuyo,
Gino ❤️`;

    const typedEl = document.getElementById("typed");
    const startBtn = document.getElementById("startBtn");
    const againBtn = document.getElementById("againBtn");
    const confettiCanvas = document.getElementById("confetti");

    let typing = false;

    function typeText(msg, cb) {
      typedEl.textContent = "";
      let i = 0;
      typing = true;
      const speed = 35;

      function step() {
        if (i < msg.length) {
          typedEl.textContent += msg[i++];
          setTimeout(step, msg[i - 1] === "\n" ? 300 : speed);
        } else {
          typing = false;
          cb && cb();
        }
      }
      step();
    }

    startBtn.addEventListener("click", () => {
      if (typing) return;
      startBtn.style.display = "none";
      typeText(text, () => {
        againBtn.style.display = "inline-block";
        startConfetti();
      });
    });

    againBtn.addEventListener("click", () => {
      typedEl.textContent = "";
      againBtn.style.display = "none";
      startBtn.style.display = "none";
      typeText(text, () => {
        againBtn.style.display = "inline-block";
        startConfetti();
      });
    });

    // Confetti
    const ctx = confettiCanvas.getContext("2d");
    function resizeCanvas() {
      confettiCanvas.width = window.innerWidth;
      confettiCanvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    function startConfetti() {
      const pieces = Array.from({ length: 150 }, () => createPiece());
      let frame;
      const duration = 220;

      function render(t) {
        ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
        pieces.forEach(p => {
          p.y += p.vy;
          p.x += p.vx;
          p.vy += p.gravity;
          if (p.y > confettiCanvas.height) Object.assign(p, createPiece());
          ctx.save();
          ctx.translate(p.x, p.y);
          ctx.rotate(p.rotation);
          ctx.fillStyle = p.color;
          ctx.fillRect(-p.size / 2, -p.size / 2, p.size, p.size * 0.6);
          ctx.restore();
        });
        if (t < duration) frame = requestAnimationFrame(render);
      }
      frame = requestAnimationFrame(render);
    }

    function createPiece() {
      const colors = ["#ff5973", "#ffd166", "#6ee7b7", "#9ad0f5", "#c084fc"];
      return {
        x: Math.random() * confettiCanvas.width,
        y: Math.random() * confettiCanvas.height - confettiCanvas.height,
        vx: -1 + Math.random() * 2,
        vy: 1 + Math.random() * 3,
        rotation: Math.random() * 2 * Math.PI,
        gravity: 0.03 + Math.random() * 0.04,
        size: 6 + Math.random() * 14,
        color: colors[Math.floor(Math.random() * colors.length)]
      };
    }
  </script>
</body>
</html>
